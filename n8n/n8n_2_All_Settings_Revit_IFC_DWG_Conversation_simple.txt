{
  "nodes": [
    {
      "parameters": {
        "formTitle": "Revit File Converter",
        "formDescription": "Configure your Revit file conversion settings",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Path to Revit Converter (RvtExporter.exe)",
              "fieldType": "string",
              "requiredField": true
            },
            {
              "fieldLabel": "Revit File Path",
              "fieldType": "string",
              "requiredField": true
            },
            {
              "fieldLabel": "Export Mode",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "basic"
                  },
                  {
                    "option": "standard"
                  },
                  {
                    "option": "complete"
                  },
                  {
                    "option": "custom"
                  }
                ]
              }
            },
            {
              "fieldLabel": "Conversion Options",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "bbox"
                  },
                  {
                    "option": "schedule"
                  },
                  {
                    "option": "sheets2pdf"
                  },
                  {
                    "option": "-no-xlsx"
                  },
                  {
                    "option": "-no-collada"
                  }
                ]
              },
              "multiselect": true
            }
          ]
        },
        "options": {}
      },
      "id": "ed5dc432-1a09-469f-8957-850dcdcaded6",
      "name": "Form UI",
      "type": "n8n-nodes-base.formTrigger",
      "position": [
        -576,
        576
      ],
      "webhookId": "c56c5696-98ac-4371-99c1-f0d452f93d89",
      "typeVersion": 2.2,
      "disabled": true
    },
    {
      "parameters": {},
      "id": "9ab6241a-3649-4198-86a4-03ccf493e365",
      "name": "Manual Trigger (Optional)",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -944,
        224
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "\n## ‚ö†Ô∏è Troubleshooting\n\n### Browser Popup Issues\nIf the form doesn't open:\n1. Look for a popup blocker icon in your browser's address bar\n2. Click it and select \"Always allow popups from this site\"\n3. Refresh the page and try again\n\n### Executable Path Issues\nIf conversion fails, ensure you're using the correct path:\n\n‚úÖ **Correct path:**\n```\nC:\\DDC_Converter_Revit\\datadrivenlibs\\RvtExporter.exe\n```\n\n‚ùå **Incorrect path:**\n```\nC:\\Community\\DDC_Converter_Revit\\RvtExporter.exe",
        "height": 540,
        "width": 524,
        "color": 7
      },
      "id": "f97c75a2-986d-40fc-b9af-bb6aad09e866",
      "name": "Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1552,
        816
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9cbd4ec9-df24-41e8-b47a-720a4cdb733b",
              "name": "path_to_revit_converter",
              "type": "string",
              "value": "C:\\Users\\Artem Boiko\\Desktop\\n8n\\cad2data-Revit-IFC-DWG-DGN-pipeline-with-conversion-validation-qto-main\\cad2data-Revit-IFC-DWG-DGN-pipeline-with-conversion-validation-qto-main\\DDC_Converter_Revit\\RvtExporter.exe"
            },
            {
              "id": "aa834467-80fb-476a-bac1-6728478834f0",
              "name": "revit_file",
              "type": "string",
              "value": "C:\\Users\\Artem Boiko\\Desktop\\n8n\\cad2data-Revit-IFC-DWG-DGN-pipeline-with-conversion-validation-qto-main\\cad2data-Revit-IFC-DWG-DGN-pipeline-with-conversion-validation-qto-main\\Sample_Projects\\2022 rstadvancedsampleproject.rvt"
            },
            {
              "id": "c3939399-e855-44a7-bb47-83dbb1e85e4f",
              "name": "(optional) Export mode (basic, standard, complete, custom) ",
              "type": "string",
              "value": "basic"
            },
            {
              "id": "748a7f80-f0cb-4147-bb22-6f88818c5a63",
              "name": "(optional) Add the BoundingBox geometry of each element in XLSX ",
              "type": "string",
              "value": "bbox"
            },
            {
              "id": "75f4016f-f04e-48ae-aae6-c231a5cc69aa",
              "name": "(optional) Export all Schedules ",
              "type": "string",
              "value": "schedule"
            },
            {
              "id": "bfbbccdb-e781-47fd-8e84-107f1ef57460",
              "name": "(optional) Export all Sheets to PDF",
              "type": "string",
              "value": "sheets2pdf"
            },
            {
              "id": "acc49689-ab70-4620-87ca-309ed90c0acd",
              "name": "(optional) Disable export to .xlsx format",
              "type": "string",
              "value": "-no-xlsx"
            },
            {
              "id": "bcbb4a29-c290-4ca4-b71b-1df755a14458",
              "name": "(optional) Disable export to .dae format ",
              "type": "string",
              "value": "-no-collada"
            },
            {
              "id": "b513c17c-a174-44cf-b935-36b3855624ba",
              "name": "(optional) output_folder",
              "type": "string",
              "value": "C:\\Users\\ars\\source\\repos\\DataDrivenConstruction\\test\\sample_files\\test"
            }
          ]
        },
        "options": {}
      },
      "id": "355a675f-2dc4-4b7f-b6c7-08a00553716a",
      "name": "Set the conversion variables",
      "type": "n8n-nodes-base.set",
      "position": [
        -576,
        224
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "content": "### Option 1: Manual Variables\n- Click **\"Manual Trigger\"** to use pre-configured variables\n- Modify the variables in the **\"Set Variables\"** node as needed\n\n## üîß Configuration\n- Update the **RvtExporter.exe** path in the form or variables\n- Ensure the path points to the executable inside the **`datadrivenlibs`** folder",
        "height": 420,
        "width": 428,
        "color": 4
      },
      "id": "e8c3b9d2-9925-4f22-a936-e54c83a9f6c8",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -752,
        -16
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "### Option 2: Form UI\n- Activate and click **\"Form UI\"** to open the web form\n- Fill in your converter path and Revit file path\n- Select export mode and options\n\n\n",
        "height": 376,
        "width": 428,
        "color": 5
      },
      "id": "7657ba3a-de3c-4848-9ffa-15f660168896",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -752,
        416
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "jsCode": "const { execSync } = require('child_process');\ntry {\n  const cmd = \"// TODO: set command\";\n  const result = execSync(cmd, { encoding: 'utf-8', timeout: 120000 });\n  return [{ json: { stdout: result, exitCode: 0 } }];\n} catch (e) {\n  return [{ json: { stderr: e.stderr || e.message, exitCode: e.status || 1 } }];\n}"
      },
      "id": "2d41cbd2-2ca3-4e6f-b523-a4ba0cff0a16",
      "name": "Converting the project into a structured form1",
      "type": "n8n-nodes-base.code",
      "position": [
        -224,
        352
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "content": "",
        "height": 836,
        "width": 1020,
        "color": 7
      },
      "id": "6e8f5fac-0a1f-490f-aaa5-e91e5375ac9b",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1008,
        -32
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## üìã Options Parameter Configuration Guide\n\n## üéØ Overview\nThe Options parameter allows you to customize the export process with various flags and settings. Multiple options can be combined using spaces.\n\n## üöÄ Available Options\n\n### üì¶ Export Modes\n| Mode   | Description |\n|------|-------------|\n| `basic`   |  Minimal export with essential data only |\n| `standard`   | Default export level with standard properties |\n| `complete`   | Full export including all available data |\n| `custom`   | Custom export using category file specification |\n\n### üõ†Ô∏è Feature Flags\n| Option | Description |\n|--------|-------------|\n| `bbox` | Add BoundingBox geometry of each element in XLSX |\n| `schedule` | Export all Schedules |\n| `sheets2pdf` | Export all Sheets to PDF format |\n| `[<output file>]` | Specify custom output file path |\n| `[<category file>]` | Text file with category names (required for custom mode) |\n\n### üö´ Disable Options\n| Option | Description |\n|--------|-------------|\n| `-no-xlsx` | Disable export to .xlsx format |\n| `-no-collada` | Disable export to .dae format |\n\n---\n\n## üìù Notes\n- All options are case-sensitive\n- Invalid combinations will be ignored\n- Default behavior applies when no options are specified",
        "height": 836,
        "width": 520
      },
      "id": "6bb3830c-9e39-47e1-bfed-e9786007f144",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1552,
        -32
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "run-DO7lywP4",
        "responseMode": "lastNode",
        "options": {}
      },
      "id": "webhook-DO7lywP4",
      "name": "Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1152,
        384
      ],
      "webhookId": "5f73054e-dd72-4545-823c-31555cf9ffea"
    }
  ],
  "connections": {
    "Manual Trigger (Optional)": {
      "main": [
        [
          {
            "node": "Set the conversion variables",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook Trigger": {
      "main": [
        [
          {
            "node": "Set the conversion variables",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "instanceId": "06264f9623e205074e9489830ccdc830bd45718f4ec7a306f423b0c7a104f1a6"
  }
}